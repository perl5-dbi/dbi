.\" -*- mode: troff; coding: utf-8 -*-
.\" Automatically generated by Pod::Man v6.0.2 (Pod::Simple 3.45)
.\"
.\" Standard preamble:
.\" ========================================================================
.de Sp \" Vertical space (when we can't use .PP)
.if t .sp .5v
.if n .sp
..
.de Vb \" Begin verbatim text
.ft CW
.nf
.ne \\$1
..
.de Ve \" End verbatim text
.ft R
.fi
..
.\" \*(C` and \*(C' are quotes in nroff, nothing in troff, for use with C<>.
.ie n \{\
.    ds C` ""
.    ds C' ""
'br\}
.el\{\
.    ds C`
.    ds C'
'br\}
.\"
.\" Escape single quotes in literal strings from groff's Unicode transform.
.ie \n(.g .ds Aq \(aq
.el       .ds Aq '
.\"
.\" If the F register is >0, we'll generate index entries on stderr for
.\" titles (.TH), headers (.SH), subsections (.SS), items (.Ip), and index
.\" entries marked with X<> in POD.  Of course, you'll have to process the
.\" output yourself in some meaningful fashion.
.\"
.\" Avoid warning from groff about undefined register 'F'.
.de IX
..
.nr rF 0
.if \n(.g .if rF .nr rF 1
.if (\n(rF:(\n(.g==0)) \{\
.    if \nF \{\
.        de IX
.        tm Index:\\$1\t\\n%\t"\\$2"
..
.        if !\nF==2 \{\
.            nr % 0
.            nr F 2
.        \}
.    \}
.\}
.rr rF
.\"
.\" Required to disable full justification in groff 1.23.0.
.if n .ds AD l
.\" ========================================================================
.\"
.IX Title "DBI::DBD::Metadata 3"
.TH DBI::DBD::Metadata 3 2015-05-28 "perl v5.40.0" "User Contributed Perl Documentation"
.\" For nroff, turn off justification.  Always turn off hyphenation; it makes
.\" way too many mistakes in technical documents.
.if n .ad l
.nh
.SH NAME
DBI::DBD::Metadata \- Generate the code and data for some DBI metadata methods
.SH SYNOPSIS
.IX Header "SYNOPSIS"
The idea is to extract metadata information from a good quality
ODBC driver and use it to generate code and data to use in your own
DBI driver for the same database.
.PP
To generate code to support the get_info method:
.PP
.Vb 1
\&  perl \-MDBI::DBD::Metadata \-e "write_getinfo_pm(\*(Aqdbi:ODBC:dsn\-name\*(Aq,\*(Aquser\*(Aq,\*(Aqpass\*(Aq,\*(AqDriver\*(Aq)"
\&
\&  perl \-MDBI::DBD::Metadata \-e write_getinfo_pm dbi:ODBC:foo_db username password Driver
.Ve
.PP
To generate code to support the type_info method:
.PP
.Vb 1
\&  perl \-MDBI::DBD::Metadata \-e "write_typeinfo_pm(\*(Aqdbi:ODBC:dsn\-name\*(Aq,\*(Aquser\*(Aq,\*(Aqpass\*(Aq,\*(AqDriver\*(Aq)"
\&
\&  perl \-MDBI::DBD::Metadata \-e write_typeinfo_pm dbi:ODBC:dsn\-name user pass Driver
.Ve
.PP
Where \f(CW\*(C`dbi:ODBC:dsn\-name\*(C'\fR is the connection to use to extract the
data, and \f(CW\*(C`Driver\*(C'\fR is the name of the driver you want the code
generated for (the driver name gets embedded into the output in
numerous places).
.SH "Generating a GetInfo package for a driver"
.IX Header "Generating a GetInfo package for a driver"
The \f(CW\*(C`write_getinfo_pm\*(C'\fR in the DBI::DBD::Metadata module generates a
DBD::Driver::GetInfo package on standard output.
.PP
This method generates a DBD::Driver::GetInfo package from the data
source you specified in the parameter list or in the environment
variable DBI_DSN.
DBD::Driver::GetInfo should help a DBD author implement the DBI
\&\fBget_info()\fR method.
Because you are just creating this package, it is very unlikely that
DBD::Driver already provides a good implementation for \fBget_info()\fR.
Thus you will probably connect via DBD::ODBC.
.PP
Once you are sure that it is producing reasonably sane data, you should
typically redirect the standard output to lib/DBD/Driver/GetInfo.pm, and
then hand edit the result.
Do not forget to update your Makefile.PL and MANIFEST to include this as
an extra PM file that should be installed.
.PP
If you connect via DBD::ODBC, you should use version 0.38 or greater;
.PP
Please take a critical look at the data returned!
ODBC drivers vary dramatically in their quality.
.PP
The generator assumes that most values are static and places these
values directly in the \f(CW%info\fR hash.
A few examples show the use of CODE references and the implementation
via subroutines.
It is very likely that you will have to write additional subroutines for
values depending on the session state or server version, e.g.
SQL_DBMS_VER.
.PP
A possible implementation of \fBDBD::Driver::db::get_info()\fR may look like:
.PP
.Vb 7
\&  sub get_info {
\&    my($dbh, $info_type) = @_;
\&    require DBD::Driver::GetInfo;
\&    my $v = $DBD::Driver::GetInfo::info{int($info_type)};
\&    $v = $v\->($dbh) if ref $v eq \*(AqCODE\*(Aq;
\&    return $v;
\&  }
.Ve
.PP
Please replace Driver (or "<foo>") with the name of your driver.
Note that this stub function is generated for you by write_getinfo_pm
function, but you must manually transfer the code to Driver.pm.
.SH "Generating a TypeInfo package for a driver"
.IX Header "Generating a TypeInfo package for a driver"
The \f(CW\*(C`write_typeinfo_pm\*(C'\fR function in the DBI::DBD::Metadata module generates
on standard output the data needed for a driver\*(Aqs type_info_all method.
It also provides default implementations of the type_info_all
method for inclusion in the driver\*(Aqs main implementation file.
.PP
The driver parameter is the name of the driver for which the methods
will be generated; for the sake of examples, this will be "Driver".
Typically, the dsn parameter will be of the form "dbi:ODBC:odbc_dsn",
where the odbc_dsn is a DSN for one of the driver\*(Aqs databases.
The user and pass parameters are the other optional connection
parameters that will be provided to the DBI connect method.
.PP
Once you are sure that it is producing reasonably sane data, you should
typically redirect the standard output to lib/DBD/Driver/TypeInfo.pm,
and then hand edit the result if necessary.
Do not forget to update your Makefile.PL and MANIFEST to include this as
an extra PM file that should be installed.
.PP
Please take a critical look at the data returned!
ODBC drivers vary dramatically in their quality.
.PP
The generator assumes that all the values are static and places these
values directly in the \f(CW%info\fR hash.
.PP
A possible implementation of \fBDBD::Driver::type_info_all()\fR may look like:
.PP
.Vb 5
\&  sub type_info_all {
\&    my ($dbh) = @_;
\&    require DBD::Driver::TypeInfo;
\&    return [ @$DBD::Driver::TypeInfo::type_info_all ];
\&  }
.Ve
.PP
Please replace Driver (or "<foo>") with the name of your driver.
Note that this stub function is generated for you by the write_typeinfo_pm
function, but you must manually transfer the code to Driver.pm.
.SH AUTHORS
.IX Header "AUTHORS"
Jonathan Leffler <jleffler@us.ibm.com> (previously <jleffler@informix.com>),
Jochen Wiedmann <joe@ispsoft.de>,
Steffen Goeldner <sgoeldner@cpan.org>,
and Tim Bunce <dbi\-users@perl.org>.
